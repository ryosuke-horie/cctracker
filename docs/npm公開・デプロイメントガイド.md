# npmå…¬é–‹ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰

## æ¦‚è¦

cctrackerã‚’npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å…¬é–‹ã—ã€`npx cctracker`ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰ã§ã™ã€‚

## ç¾åœ¨ã®æº–å‚™çŠ¶æ³

### âœ… å®Œäº†æ¸ˆã¿

- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ**: å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒé©åˆ‡ã«è¨­å®šæ¸ˆã¿
- **CLIå®Ÿè¡Œç’°å¢ƒ**: shebangãƒ©ã‚¤ãƒ³ã€binã‚¨ãƒ³ãƒˆãƒªã€filesè¨­å®šãŒå®Œäº†
- **ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œç¢ºèª**: `npm link`ã«ã‚ˆã‚‹å‹•ä½œç¢ºèªæ¸ˆã¿
- **å“è³ªä¿è¨¼**: ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸89%ã€å‹ãƒã‚§ãƒƒã‚¯ã€ãƒªãƒ³ãƒˆå…¨ã¦é€šé

### â³ å®Ÿè£…å¾…ã¡

- **npmèªè¨¼è¨­å®š**: å…¬é–‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è¨­å®š
- **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åç¢ºèª**: æ—¢å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
- **å…¬é–‹è‡ªå‹•åŒ–**: GitHub Actions ã«ã‚ˆã‚‹è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æˆ¦ç•¥

## å…¬é–‹å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### 1. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¨­å®šã®ç¢ºèª

```bash
# ç¾åœ¨ã®è¨­å®šç¢ºèª
cat package.json | grep -A5 -B5 '"name"\|"version"\|"bin"\|"files"'

# æœŸå¾…ã•ã‚Œã‚‹è¨­å®š
{
  "name": "cctracker",
  "version": "0.1.0",
  "bin": {
    "cctracker": "./dist/cli.js"
  },
  "files": [
    "dist/**/*"
  ]
}
```

### 2. ãƒ“ãƒ«ãƒ‰ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ¤œè¨¼

```bash
# ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
npm run build

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆç¢ºèª
npm pack --dry-run

# ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œç¢ºèª
npm link
cctracker --help
npm unlink -g cctracker
```

### 3. å“è³ªä¿è¨¼ãƒã‚§ãƒƒã‚¯

```bash
# å…¨ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
npm run lint          # ãƒªãƒ³ãƒˆ
npm run typecheck     # å‹ãƒã‚§ãƒƒã‚¯
npm run test:run      # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:coverage # ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèªï¼ˆ89%ä»¥ä¸Šï¼‰
```

## å…¬é–‹æ‰‹é †

### æ–¹æ³•1: æ‰‹å‹•å…¬é–‹

```bash
# 1. npmèªè¨¼
npm login

# 2. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã®å¯ç”¨æ€§ç¢ºèª
npm view cctracker

# 3. å…¬é–‹å‰æœ€çµ‚ç¢ºèª
npm run build
npm run test:run

# 4. å…¬é–‹å®Ÿè¡Œ
npm publish

# 5. å‹•ä½œç¢ºèª
npx cctracker
```

### æ–¹æ³•2: GitHub Actionsè‡ªå‹•å…¬é–‹

#### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­å®šä¾‹

```yaml
# .github/workflows/publish.yml
name: Publish to npm

on:
  push:
    tags:
      - 'v*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          registry-url: 'https://registry.npmjs.org'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run tests
        run: npm run test:run
      
      - name: Build
        run: npm run build
      
      - name: Publish to npm
        run: npm publish
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
```

#### å…¬é–‹ç”¨ã‚¿ã‚°ä½œæˆ

```bash
# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã¨ã‚¿ã‚°ä½œæˆ
npm version patch  # 0.1.0 â†’ 0.1.1
npm version minor  # 0.1.0 â†’ 0.2.0
npm version major  # 0.1.0 â†’ 1.0.0

# ã‚¿ã‚°ã‚’ãƒªãƒ¢ãƒ¼ãƒˆã«ãƒ—ãƒƒã‚·ãƒ¥
git push origin --tags
```

## ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†æˆ¦ç•¥

### ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°

- **MAJOR** (X.0.0): ç ´å£Šçš„å¤‰æ›´
  - CLIã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‰Šé™¤ãƒ»å¤‰æ›´
  - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®å¤‰æ›´
  - æœ€å°Node.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å¼•ãä¸Šã’

- **MINOR** (0.X.0): æ©Ÿèƒ½è¿½åŠ 
  - æ–°ã—ã„CLIã‚³ãƒãƒ³ãƒ‰ã®è¿½åŠ 
  - æ–°ã—ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®è¿½åŠ 
  - æ–°ã—ã„ãƒ—ãƒ©ãƒ³å¯¾å¿œ

- **PATCH** (0.0.X): ãƒã‚°ä¿®æ­£
  - æ—¢å­˜æ©Ÿèƒ½ã®ä¿®æ­£
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„
  - ä¾å­˜é–¢ä¿‚ã®æ›´æ–°

### ãƒ—ãƒ¬ãƒªãƒªãƒ¼ã‚¹ç‰ˆ

```bash
# ãƒ™ãƒ¼ã‚¿ç‰ˆå…¬é–‹
npm version prerelease --preid=beta  # 0.1.0-beta.0
npm publish --tag beta

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•
npx cctracker@beta
```

## å…¬é–‹å¾Œã®ç®¡ç†

### 1. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–

```bash
# ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ•°ç¢ºèª
npm view cctracker

# è©³ç´°çµ±è¨ˆ
npm info cctracker
```

### 2. å•é¡Œå¯¾å¿œ

```bash
# ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®å–ã‚Šä¸‹ã’
npm unpublish cctracker@0.1.0

# éæ¨å¥¨ãƒãƒ¼ã‚¯
npm deprecate cctracker@0.1.0 "Please upgrade to 0.1.1"
```

### 3. ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆé€šçŸ¥

#### package.jsonã®æ›´æ–°

```json
{
  "repository": {
    "type": "git",
    "url": "https://github.com/yourusername/cctracker.git"
  },
  "bugs": {
    "url": "https://github.com/yourusername/cctracker/issues"
  },
  "homepage": "https://github.com/yourusername/cctracker#readme"
}
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **èªè¨¼ã‚¨ãƒ©ãƒ¼**: `npm login`ã§èªè¨¼æƒ…å ±ã‚’ç¢ºèª
2. **ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åé‡è¤‡**: `npm view <name>`ã§ç¢ºèªå¾Œã€åå‰å¤‰æ›´
3. **ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼**: `npm run build`ã®æˆåŠŸã‚’ç¢ºèª
4. **æ¨©é™ã‚¨ãƒ©ãƒ¼**: npmçµ„ç¹”ã®æ¨©é™è¨­å®šã‚’ç¢ºèª

### å…¬é–‹å‰ã®æœ€çµ‚ç¢ºèª

```bash
# å®Œå…¨ãªã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰
rm -rf node_modules dist
npm install
npm run build
npm run test:run

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…å®¹ç¢ºèª
tar -tzf $(npm pack)
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

1. **npm TOKEN**: GitHub Secretsã§ç®¡ç†
2. **ä¾å­˜é–¢ä¿‚**: å®šæœŸçš„ãªè„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
3. **å…¬é–‹ç¯„å›²**: ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã®é™¤å¤–è¨­å®š

```bash
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
npm audit
npm audit fix
```

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [é–‹ç™ºãƒ«ãƒ¼ãƒ«](./é–‹ç™ºãƒ«ãƒ¼ãƒ«.md) - ã‚³ãƒ¼ãƒ‰å“è³ªã¨CI/CDè¦ä»¶
- [README.md](../README.md) - ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã¨npxå®Ÿè¡Œæ–¹æ³•
- [ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸](./ãƒ†ã‚¹ãƒˆä»•æ§˜æ›¸.md) - å“è³ªä¿è¨¼ã®è©³ç´°

---

## ğŸ“‹ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å…¬é–‹æº–å‚™
- [ ] npmèªè¨¼è¨­å®šå®Œäº†
- [ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã®å¯ç”¨æ€§ç¢ºèª
- [ ] å…¨å“è³ªãƒã‚§ãƒƒã‚¯é€šéï¼ˆlint, typecheck, testï¼‰
- [ ] ãƒ“ãƒ«ãƒ‰æˆåŠŸç¢ºèª
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œç¢ºèª

### è‡ªå‹•åŒ–è¨­å®š
- [ ] GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆ
- [ ] NPM_TOKENã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè¨­å®š
- [ ] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†æˆ¦ç•¥ã®æ±ºå®š
- [ ] ãƒªãƒªãƒ¼ã‚¹ãƒãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ

### å…¬é–‹å¾Œãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—
- [ ] ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å‹•ä½œç¢ºèª
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
- [ ] ä½¿ç”¨çµ±è¨ˆã®ç›£è¦–è¨­å®š
- [ ] å•é¡Œå ±å‘Šãƒãƒ£ãƒ³ãƒãƒ«ã®æ•´å‚™

ã“ã®ã‚¬ã‚¤ãƒ‰ã«å¾“ã£ã¦ã€cctrackerã‚’npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ã«å…¬é–‹ã§ãã¾ã™ã€‚